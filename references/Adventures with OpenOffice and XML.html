
<!-- saved from url=(0052)https://www.xml.com/pub/a/2001/02/07/openoffice.html -->
<html xmlns:functx="http://www.functx.com" class="" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      
      
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="keywords" content="www.XML.com,Textuality Services,Matt Sergeant,Programming, Style, Publishing, Tools,Adventures with OpenOffice and XML">
      <meta name="date" content="February 7, 2001">
      <meta name="pagename" content="Adventures with OpenOffice and XML">
      <meta name="site" content="www.XML.com">
      <meta name="author" content="Matt Sergeant">
      <title>Adventures with OpenOffice and XML</title>
      <meta name="description" content="">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="icon" type="image/x-icon" href="https://www.xml.com/static/favicon.ico">
      <link rel="stylesheet" href="./Adventures with OpenOffice and XML_files/73bd8c42a922.css" type="text/css">
      <link href="./Adventures with OpenOffice and XML_files/css(1)" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="./Adventures with OpenOffice and XML_files/print.css" media="print"><script src="./Adventures with OpenOffice and XML_files/osd.js"></script><script src="./Adventures with OpenOffice and XML_files/pubads_impl_rendering_319.js"></script><script async="" src="./Adventures with OpenOffice and XML_files/apstag.js"></script><script async="" src="./Adventures with OpenOffice and XML_files/analytics.js"></script><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
                            
    ga('create', 'UA-79723435-1', 'auto');
    ga('send', 'pageview');                            
</script><script async="" src="./Adventures with OpenOffice and XML_files/gpt.js"></script><script>
            var googletag = googletag || {};
            googletag.cmd = googletag.cmd || [];
          </script><script>
            googletag.cmd.push(function() {
            googletag.defineSlot('/21754636678/xml.com-1', [[160, 600], [120, 240], [300, 250]], 'div-gpt-ad-1550450394815-0').addService(googletag.pubads());
            googletag.defineSlot('/21754636678/xml.com-2', [[300, 250]], 'div-gpt-ad-1550513522284-0').addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.pubads().disableInitialLoad();
            googletag.enableServices();
            });
          </script><script>
            //load the apstag.js library
            !function(a9,a,p,s,t,A,g){if(a[a9])return;function q(c,r){a[a9]._Q.push([c,r])}a[a9]={init:function(){q("i",arguments)},fetchBids:function(){q("f",arguments)},setDisplayBids:function(){},targetingKeys:function(){return[]},_Q:[]};A=p.createElement(s);A.async=!0;A.src=t;g=p.getElementsByTagName(s)[0];g.parentNode.insertBefore(A,g)}("apstag",window,document,"script","//c.amazon-adsystem.com/aax2/apstag.js");
            
            //initialize the apstag.js library on the page to allow bidding
            apstag.init({
            pubID: '32676f4f-8458-484f-b742-dcd7ad80a504', //enter your pub ID here as shown above, it must within quotes
            adServer: 'googletag'
            });
            apstag.fetchBids({
            slots: [{
            slotID: 'div-gpt-ad-1550450394815-0', //example: 'div-gpt-ad-1475102693815-0'
            slotName: '21754636678/xml.com-1', //example: '12345/box-1'
            sizes: [[160,600], [300,250], [120,400]] //example: [[300,250], [300,600]]
            },
            {
            slotID: 'div-gpt-ad-1550513522284-0', //example: 'div-gpt-ad-1475185990716-0'
            slotName: '21754636678/xml.com-2', //example: '12345/leaderboard-1'
            sizes: [[300,250]] //example: [[728,90]]
            }],
            timeout: 2e3
            }, function(bids) {
            // set apstag targeting on googletag, then trigger the first DFP request in googletag's disableInitialLoad integration
            googletag.cmd.push(function(){
            apstag.setDisplayBids();
            googletag.pubads().refresh();
            });
            }); 
          </script><meta class="foundation-mq"><link rel="preload" href="./Adventures with OpenOffice and XML_files/f(2).txt" as="script"><script type="text/javascript" src="./Adventures with OpenOffice and XML_files/f(2).txt"></script><link rel="preload" href="./Adventures with OpenOffice and XML_files/f(3).txt" as="script"><script type="text/javascript" src="./Adventures with OpenOffice and XML_files/f(3).txt"></script><script src="./Adventures with OpenOffice and XML_files/pubads_impl_319.js" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-32/html/container.html"></head>
   <body class="homepage" data-whatinput="mouse">
      <div class="title-bar hide-for-print" data-responsive-toggle="menu" data-hide-for="large" style="display: none;"><button class="menu-icon" type="button" value="Menu" data-toggle="data-toggle"></button><div class="title-bar-title">Menu</div>
      </div>
      <div class="row">
         
         <div class="top-bar hide-for-print" id="menu">
            
            <div class="top-bar-left">
               <a href="https://www.xml.com/">
                  <img src="./Adventures with OpenOffice and XML_files/small-logo.png" alt="XML.com logo">
                  </a>
               
            </div>
            
            <div class="top-bar-right">
               
               <ul class="menu vertical medium-horizontal dropdown" data-responsive-menu="drilldown medium-dropdown" role="menubar" data-dropdown-menu="zxyaf1-dropdown-menu">
                  
                  <li role="menuitem">
                     <a href="https://www.xml.com/" tabindex="0">Home</a>
                     
                  </li>
                  
                  <li role="menuitem">
                     <a href="https://www.xml.com/articles/">Articles</a>
                     
                  </li>
                  
                  <li role="menuitem">
                     <a href="https://www.xml.com/authors/">Authors</a>
                     
                  </li>
                  
                  <li role="menuitem">
                     <a href="https://www.xml.com/news/">News</a>
                     
                  </li>
                  
                  <li role="menuitem">
                     <a href="https://www.xml.com/job-board/">Job Board</a>
                     
                  </li>
                  
                  <li class="has-submenu  is-dropdown-submenu-parent opens-left" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-label="About">
                     <a href="https://www.xml.com/about/">About</a>
                     
                     <ul class="submenu menu vertical is-dropdown-submenu first-sub" data-submenu="" aria-hidden="true" role="menu">
                        
                        <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                           <a href="https://www.xml.com/about/contribute/">Contribute</a>
                           
                        </li>
                        
                        <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                           <a href="https://www.xml.com/about/style-guide/">Style guide</a>
                           
                        </li>
                        
                        <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                           <a href="https://www.xml.com/about/copyright/">Copyright</a>
                           
                        </li>
                        
                        <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                           <a href="https://www.xml.com/about/contact/">Contact</a>
                           
                        </li>
                        
                        <li role="menuitem" class="is-submenu-item is-dropdown-submenu-item">
                           <a href="https://www.xml.com/about/privacy/">Privacy Policy</a>
                           
                        </li> 
                        
                     </ul>
                     
                  </li>
                  
                  <li class="has-form" style="background: transparent;" role="menuitem">
                     
                     <form id="cse-search-box" action="https://google.com/cse">
                        <input type="hidden" name="cx" value="partner-pub-9264479583913780:3063344556">
                        <input type="hidden" name="ie" value="UTF-8">
                        <input type="text" placeholder="Search" name="q" title="Search">
                        
                        <!--<input type="submit" name="sa" value="Search">-->
                        
                     </form>
                     
                  </li>
                  
               </ul>
               
            </div>
            
         </div>
         
      </div>
      <div class="row">
         <div class="medium-9 columns">
            <div id="content">
               <div class="medium-12 columns" role="content">
                  <article class="article">
                     <h3>Adventures with OpenOffice and XML</h3>
                     <p>February 7, 2001</p>
                     <p><a href="https://www.xml.com/pub/au/22">Matt Sergeant</a></p>
                     <p>At the Open Source conference in Monterey last year, Sun announced their plans to
                        release
                        the current source code for Star Office, renamed <a href="http://www.openoffice.org/">OpenOffice</a>. In October they followed up on their plans, releasing both the source
                        code and binaries for OpenOffice build 605. One of the features added since Star Office
                        5.2
                        was the ability to save files as XML.
                     </p>
                     <p>In addition to being open source, saving as XML makes OpenOffice truly open. Aside
                        from
                        being open source, XML's self-documenting nature allows us to dive into the document
                        format
                        without having to dive into C++. And more significantly, XML allows us to use simple,
                        free
                        tools to manipulate the documents themselves.
                     </p>
                     <p>In this article we will examine the structure of the format. We will not go into great
                        detail, as Sun has already done so in a 400 page specification. Instead we will focus
                        on
                        using the XML to generate something of potential interest to web developers and content
                        editors.
                     </p>
                     <p>It's important to note that OpenOffice isn't ready to be an every day word processor.
                        Components like printing and spell checking were removed in the migration to open
                        source
                        because Sun didn't own them. I expect they will be added back by the open source community
                        as time goes by. When Sun releases Star Office 6 I expect they will include the proprietary
                        spell checker and print engine again. Also worth noting is that OpenOffice is relatively
                        unstable at the moment. I experienced several crashes and other serious problems while
                        working on this article. Thanks to Daniel Vogelheim of Sun for helping me through
                        those
                        troubles.
                     </p>
                     <h3>XML Requirements</h3>
                     <p>Having migrated the project to open source, Sun did the right thing in opening the
                        development process. Hence all of Sun's decisions are open to public discussion on
                        the
                        OpenOffice mailing lists. Sun had a specific set of requirements when designing the
                        XML
                        format for OpenOffice. The short list of requirements can be found on the <a href="http://xml.openoffice.org/">OpenOffice XML site </a>; but let's review the list
                        here.
                     </p>
                     <p>
                        <strong>Core Requirements:</strong>
                        
                     </p>
                     <ol>
                        
                        <li>
                           
                           <p>The file format must be capable of being used as an office program's native file
                              format. The format must be "non-lossy" and must support (at least) the full capability
                              of a StarOffice/OpenOffice document. The format is likely to be used for document
                              interchange but that alone is not enough.
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>Structured content should make use of XML's structuring capabilities and be represented
                              in terms of XML elements and attributes.
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>The file format must be fully documented and have no "secret" features.</p>
                           
                        </li>
                        
                        <li>
                           
                           <p>OpenOffice must be the reference implementation for this file format.</p>
                           
                        </li>
                        
                     </ol>
                     <p>Sun plans for XML to become the default save format. This is not the case presently
                        in
                        build 605. I have to select "Save As" to export to XML, but when OpenOffice is finally
                        released expect it to be the default save format.
                     </p>
                     <h4>Packaging</h4>
                     <p>OpenOffice documents can be compound -- that is, they can contain multiple documents
                        of
                        different formats. Sun's examined the different ways of packaging up compound documents
                        using XML. It picked the ZIP format. Initially this choice surprised me since I've
                        always
                        thought the most standard way to store binary data in XML was base64 encoding. However
                        this
                        decision is fully <a href="http://xml.openoffice.org/package.html">explained in detail</a>
                        on the OpenOffice site. Two factors were vital: ZIP's indexing ability and the importance
                        of
                        being able to load and save on demand. It means that an OpenOffice file will be a
                        ZIP file
                        containing at least one XML file, along with other files of relevance to the document
                        (such
                        as images, and possibly other OpenOffice files).
                     </p>
                     <h3>The OpenOffice XML Format</h3>
                     <p>What about the details of the XML format itself. A specification document is <a href="http://xml.openoffice.org/xml_specification_draft.pdf">available online,</a>
                        although it's a big document so I'll distill some of it here.
                     </p>
                     <h4>Document Root</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;office:document&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>The document root element is <code>&lt;office:document&gt;</code>. (I'm leaving namespaces
                        URIs out; OpenOffice appears to use namespaces to its advantage in a very clean manner,
                        unlike other office suites.)
                     </p>
                     <p>According to the specification, this is a generic document root. All OpenOffice documents
                        have this document root. A spreadsheet and word processor file will have the same
                        document
                        root, allowing us to do some generic processing.
                     </p>
                     <h4>Metadata</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;office:meta&gt;

   &lt;dc:title&gt;Adventures with Open Office and XML&lt;/dc:title&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>Document metadata is one of the more interesting features of the OpenOffice XML format.
                        OpenOffice metadata is enclosed in the <code>&lt;office:meta&gt;</code> tag at the top level
                        of the document, immediately following the document root. Sun chose Dublin Core for
                        the
                        majority of their metadata elements. Where Dublin Core did not have an available element,
                        Sun created elements in their <code>meta</code> namespace, including
                     </p>
                     <ul>
                        
                        <li>
                           
                           <p>generator -- the application that created this file;</p>
                           
                        </li>
                        
                        <li>
                           
                           <p>initial-creator -- the original author of the file (dc:creator is used for the person
                              who last edited the file);
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>creation-date -- the date this file was first created (dc:date is used for the date
                              of
                              the last edit);
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>keywords -- can be edited in the document properties dialog.</p>
                           
                        </li>
                        
                     </ul>
                     <p>How is this useful? We could write a Perl script to display the author of OpenOffice
                        files.
                     </p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
use XML::XPath;

while (my $file = shift @ARGV) {

   next unless -f $file;

   eval {

     my $xp = XML::XPath-&gt;new(filename =&gt; $file);

     print $_, ": ", $xp-&gt;findvalue("//dc:creator"), "\n";

   };

}

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>If we call this script <code>dcdir</code>, the results on a directory full of OpenOffice
                        XML files might be
                     </p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
$ dcdir *.sxw

test.so.xml.sxw: Matt Sergeant

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>This works regardless of the type of OpenOffice file we are examining. With a little
                        more
                        work we can ensure that the file is an XML file of the OpenOffice format (at the moment,
                        this script will crash when it comes across a non-XML file). See Kip Hampton's regular
                        Perl
                        and XML column for more details on using XML::XPath.
                     </p>
                     <h4>Styles</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;office:styles&gt;

   &lt;style:style style:name="Source Code"

           style:family="paragraph"

           style:parent-style-name="Text body"&gt;

       &lt;style:properties fo:font-family="Courier"

               fo:margin-left="0.25inch"

               fo:font-size="11pt"/&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>OpenOffice formats text using text styles, allowing easy modification of a document's
                        appearance. Styling information is saved in the XML format. The list of defined styles
                        is
                        enclosed within the <code>&lt;office:styles&gt;</code> element.
                     </p>
                     <p>Each style, marked up with the <code>&lt;style:style&gt;</code> element, defines, in
                        attributes, a <code>style name</code>; a <code>style family</code> (for example a paragraph
                        style or text (inline) style, equivalent to <code>&lt;div&gt;</code> or
                        <code>&lt;span&gt;</code> in HTML); a <code>parent style</code> (because styles inherit
                        their parent style's attributes); and a <code>class</code>, which is used in the OpenOffice
                        style dialog box to categorize styles.
                     </p>
                     <p>Within the style element itself are style properties, which are stored in the attributes
                        of
                        the <code>&lt;style:properties&gt;</code> empty element. The properties of a style are
                        inherited from the ancestor styles and only modified properties are stored (which
                        saves
                        space). The second interesting re-use of public XML schemas occurs in the use of XSL
                        FO
                        attributes (about which there's more in "<a href="http://www.xml.com/pub/a/2001/01/17/xsl-fo/index.html">Using Formatting
                           Objects</a>") to define style properties. Theoretically this means we should be able to do
                        some formatting to produce an XSL FO document.
                     </p>
                     <p>Why would we want to do this when we can print directly from OpenOffice? I work in
                        content
                        management and application serving (see my XML.com <a href="http://www.xml.com/pub/a/2000/05/24/axkit/">article on AxKit</a>), and some of my
                        clients would like to be able to use an ordinary word processor to create content.
                        By doing
                        some preprocessing, and then passing the output to FOP or another XSL FO processor,
                        we can
                        generate PDF files automatically from content saved into the web hierarchy. (This
                        functionality isn't yet available, but please get in touch if this sort of thing interests
                        you.)
                     </p>
                     <p>It is again worth noting here that where XSL FO did not have an equivalent attribute
                        to the
                        internal implementation in OpenOffice, Sun have defined their own attributes in one
                        of the
                        OpenOffice namespaces.
                     </p>
                     <h4>Automatic Styles</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;office:automatic-styles&gt;

 &lt;style:style style:name="P1" style:family="paragraph" 

         style:parent-style-name="Title"&gt;

  &nbsp;&lt;style:properties fo:font-family="Arial" 

  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;fo:font-style-name="" fo:font-size="18pt" 

        &nbsp;  fo:font-weight="bold" fo:text-align="end" 

          &nbsp;style:justify-single-word="false" 

        &nbsp; &nbsp;fo:margin-top="0.16inch" 

        &nbsp; &nbsp;fo:margin-bottom="0.0835inch"/&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>How do you allow people to use styles, yet also allow local modifications to the fonts,
                        weight, and so on? OpenOffice does this by injecting an automatic style between the
                        text and
                        the real style, so that rather than
                     </p>
                     <blockquote>"Some text" -&gt; is of style -&gt; "Title"</blockquote>
                     <p>we have</p>
                     <blockquote>"Some text" -&gt; is of auto style -&gt; "P1" -&gt; parent style -&gt;
                        "Title"
                     </blockquote>
                     <p>OpenOffice has a section called <code>&lt;style:automatic-styles&gt;</code> following the
                        main styles definitions. Within the main body of the document, only automatic styles
                        are
                        used.
                     </p>
                     <p>There are some changes going on in this area presently. The current CVS builds at
                        Sun only
                        use automatic styles when local modifications to the formatting have been made. For
                        example,
                        suppose we make some text bold within a paragraph. OpenOffice uses the automatic style
                        to
                        define that hard formatting with a span. The result might look something like
                     </p>
                      1G
                        <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;text:p text:style-name="Text body"&gt;Some text with 

a &lt;text:span text:style-name="T1"&gt;bold&lt;/text:span&gt; word 

in it.&lt;/text:p&gt;

</pre>
                                 </td>
                              
                           </tr></tbody>
                        
                     </table>
                     <h4>Main Body Text</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;office:body&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>Finally we get to the main body of the document. Of all the sections, it's probably
                        the
                        simplest to follow. We will address each of the major tags in turn. Unlike other sections,
                        the body text is free-form, so the following tags can appear anywhere within the
                        <code>&lt;office:body&gt;</code> section.
                     </p>
                     <h4>Headings</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;text:h text:style-name="P4" text:level="1"&gt;The format

itself&lt;/text:h&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>Headings are defined with the <code>&lt;text:h&gt;</code> tag. Build 605 export uses an
                        automatic style, whereas with later builds it will likely be
                     </p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;text:h text:style-name="Heading 1"&gt;The format itself&lt;/text:h&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <h4>Paragraphs</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;text:p text:style-name="P3"&gt;Some text&lt;/text:p&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>Paragraphs of text are defined with the <code>&lt;text:p&gt;</code> tag. We can now start
                        to see that some of the tags in the body are similar to HTML, albeit in a different
                        namespace.
                     </p>
                     <h4>Spans</h4>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;text:span text:style-name="T6"&gt;spanned text&lt;/text:span&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>OpenOffice spans are exactly the same as spans in HTML. They delimit an inline section
                        of a
                        paragraph, applying alternate styling to the spanned text.
                     </p>
                     <h4>Lists</h4>
                     <p>Lists are defined by tags of similar same name as those used in <a href="http://www.docbook.org/">DocBook</a>. Specifically these are
                        <code>&lt;text:ordered-list&gt;</code>, <code>&lt;text:unordered-list&gt;</code> and
                        <code>&lt;text:list-item&gt;</code>.
                     </p>
                     <h4>Graphics</h4>
                     <p>Vector graphics can be embedded directly into the document with OpenOffice, which
                        is a nice
                        feature, but you will be even more pleased to know that OpenOffice uses SVG as its
                        native
                        vector graphics format. And these vector graphics can occur directly within the flow
                        of the
                        body document. Daniel Vogelheim informed me, however, that while mostly correct, the
                        format
                        is "mostly SVG". There are some things that OpenOffice can do with graphics that SVG
                        does
                        not define. So again they have extended the format using elements in their own
                        namespace.
                     </p>
                     <h3>Putting It All Together</h3>
                     <p>As an illustration, you can <a href="https://www.xml.com/pub/a/2001/02/07/adventure.sxw">download the source XML
                           file</a> of this article which was written in OpenOffice build 605, saved as XML, and then
                        transformed using the techniques below.
                     </p>
                     <p>How can we put the XML generated from OpenOffice to good use? What XML geeks really
                        want to
                        see is a free WYSIWYG XML editor like XMetaL or Adept. And here it is. If we restrict
                        ourselves (or our customers) to using defined styles, OpenOffice can truly be a structured
                        XML editor, without ever knowing you are editing XML.
                     </p>
                     <p>By processing the XML generated by OpenOffice, we can turn tags like <code>&lt;text:h
                           text:style-name="P10"&gt;</code> into something significantly easier to work with like
                        <code>&lt;Heading_3&gt;</code>. And for structured XML, we really don't need all the font
                        and page settings. But some of the style information may be of interest; for example
                        <code>&lt;span&gt;</code> tags may point to XSL FO styles -- which are almost identical to
                        CSS styles -- so these might be useful in trying to get a similar look if we translate
                        the
                        page to HTML.
                     </p>
                     <p>We could do this transformation with XSLT. But I prefer <a href="https://www.xml.com/pub/a/2000/07/05/xpathscript/index.html"> XPathScript</a> because it's more natural
                        to me since I can use variables, define functions and pass parameters.
                     </p>
                     <p>The code below will only work on current releases of OpenOffice (and probably works
                        best on
                        files saved from build 605), due to the aforementioned changes in the automatic styles
                        functionality.
                     </p>
                     <h4>From automatic style to the real style</h4>
                     <p>First we need to find an XPath expression that will take us from the text's style
                        name
                        (which will be an automatic style name like "P1") to the real style name. This is
                        actually
                        rather simple.
                     </p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
/office:document

/office:automatic-styles

/style:style

[@style:name="P1"]

/@style:parent-style-name

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>It finds the <code>style:parent-style-name</code> attribute of the automatic style. I call
                        this the "actual style".
                     </p>
                     <p>We can translate the actual style to a string we can use for an element name by removing
                        spaces using XPath's <code>translate()</code> function; it will change "Heading 1" to
                        "Heading_1".
                     </p>
                     <h4>A name mapping</h4>
                     <p>Next we need to setup a name mapping to translate style names to a more preferred
                        form. For
                        example, we translate "Text_body" to "para".
                     </p>
                     <p>Mappings are trivial in Perl (and hence XPathScript), we simply setup a hash.</p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
my %stylemap = (

 Text_body =&gt; "para",

);

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <h4>Adding the metadata</h4>
                     <p>Let's assume for now that we are only interested in Dublin Core metadata. To get this
                        we
                        use the simple XPath <code>/office:document/office:meta/dc:*</code>.
                     </p>
                     <h4>Transformation results</h4>
                     <p>The <a href="https://www.xml.com/pub/a/2001/02/07/so2xml.xps">full stylesheet</a> can be run using the Perl module
                        <em>XML::XPathScript</em>, which you can <a href="http://www.cpan.org/modules/by-module/XML">download from CPAN</a>. It comes with a
                        command line utility, <em>xpathscript</em>.
                     </p>
                     <p>The results of this transformation on a <a href="https://www.xml.com/pub/a/2001/02/07/test.sxw">simple OpenOffice
                           test document</a> are
                     </p>
                     <table width="*">
                        
                        <tbody>
                           
                           <tr>
                              
                              <td width="20" bgcolor="#FFFFFF">&nbsp;</td>
                              
                              <td bgcolor="#EEEEEE">
                                 <pre style="color: #800000;">
&lt;article&gt;

 &lt;artheader xmlns:dc="http://purl.org/dc/elements/1.1/&gt;"

  &nbsp;&lt;dc:title&gt;Test Example&lt;/dc:title&gt;

  &nbsp;&lt;dc:creator&gt;Matt Sergeant&lt;/dc:creator&gt;

  &nbsp;&lt;dc:date&gt;2000-11-13T21:00:01&lt;/dc:date&gt;

  &nbsp;&lt;dc:language&gt;en-US&lt;/dc:language&gt;

 &lt;/artheader&gt;

 &lt;body&gt;

   &lt;Heading_1&gt;Test&lt;/Heading_1&gt;

  &nbsp;&lt;para&gt;Here is some text&lt;/para&gt;

 &lt;/body&gt;

&lt;/article&gt;

</pre>
                                 </td>
                              
                           </tr>
                           
                        </tbody>
                        
                     </table>
                     <p>The result is much simpler than the original. We can easily work with this to transform
                        to
                        HTML using more XPathScript or XSLT.
                     </p>
                     <h4>Flat structure</h4>
                     <p>The document format follows HTML's style of headings followed by text. This is not
                        my
                        personal preference. I prefer DocBook, which models the document as a tree structure
                        --
                        sections are contained within a <code>&lt;sect1&gt;</code> tag, and sub-sections are
                        contained within the parent section, rather than just occurring in the main flow of
                        tags. A
                        tree structure makes it easier to manipulate the document. For example, generating
                        a table
                        of contents is a simple recursive loop. But with the flat format in OpenOffice it's
                        more
                        difficult as we have to maintain information about the current heading levels.
                     </p>
                     <p>It would be ideal to make the stylesheet produce a tree-shaped document instead of
                        a flat
                        one. So that is what I did. Since it requires maintaining state information about
                        the
                        current heading level. the choice of XPathScript is vindicated again since it's just
                        Perl.
                        I've written a <a href="https://www.xml.com/pub/a/2001/02/07/so2dkb.xps">stylesheet</a> that gets very close to
                        generating DocBook from OpenOffice XML files; it's what I used to provide this article
                        to
                        XML.com, followed by another transformation to generate HTML. I can do this in one
                        step
                        using AxKit pipelines. I save the file into the web document root, and AxKit transforms
                        it
                        to HTML for me.
                     </p>
                     <h3>OpenOffice for Content Management</h3>
                     <p>As I mentioned earlier, my aim is to use OpenOffice as the editing component for a
                        content
                        management system (specifically, as an add-on for AxKit). The one thing that has thrown
                        a
                        monkeywrench into the works is OpenOffice's packaging format. You cannot pass ZIP
                        archives
                        to an XML parser. Since XML application servers like AxKit and Cocoon allow the XML
                        provider
                        to be overridden, we can even reach into those ZIP archives to extract the XML before
                        further processing with stylesheets.
                     </p>
                     <p>In November at XML Dev Con in San Jose I gave a talk about the current state of XML
                        applications for web developers in the open source world. My conclusion was that while
                        the
                        server side of XML processing is competitive with, if not better than, proprietary
                        products,
                        the client-editor side of things was a long way off. OpenOffice's XML format changes
                        everything. Now you really can edit a richly formatted document in a WYSIWYG word
                        processor
                        and publish it directly to the Web. That's a huge step in the right direction for
                        the open
                        source community.
                     </p>
                     <p>Other ideas that could be implemented include</p>
                     <ul>
                        
                        <li>
                           
                           <p>convert a presentation file to Sun's XML slide format and then to SVG using their
                              toolkit;
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>use stylesheets to generate OpenOffice's XML format from XML formats like DocBook
                              or
                              XHTML (or the output from the transformation above) to create a form of round-trip
                              editing;
                           </p>
                           
                        </li>
                        
                        <li>
                           
                           <p>use stylesheets to generate XHTML directly, rather than an interim format;</p>
                           
                        </li>
                        
                     </ul>
                     <p>Doubtless there are many more possibilities. I look forward to feedback about this
                        article.
                     </p>
                  </article>
               </div>
            </div>
         </div>
         <aside id="sidebar" class="medium-3 columns hide-for-print text-right">
            
            <div class="text-center">
               
               <!-- /21754636678/xml.com-1 --> 
               <div id="div-gpt-ad-1550450394815-0" data-google-query-id="CICtjevpmOECFQSpaQodLhALBQ"> <script> googletag.cmd.push(function() { googletag.display('div-gpt-ad-1550450394815-0'); }); </script> <div id="google_ads_iframe_/21754636678/xml.com-1_0__container__" style="border: 0pt none; width: 160px; height: 600px;"></div></div>
               
            </div>
            
            <div class="text-center">
               
               <!-- /21754636678/xml.com-2 --> 
               <div id="div-gpt-ad-1550513522284-0" style="height:250px; width:300px;" data-google-query-id="CJ-5juvpmOECFQSpaQodLhALBQ">  <div id="google_ads_iframe_/21754636678/xml.com-2_0__container__" style="border: 0pt none; display: inline-block; width: 300px; height: 250px;"><iframe frameborder="0" src="./Adventures with OpenOffice and XML_files/container.html" id="google_ads_iframe_/21754636678/xml.com-2_0" title="3rd party ad content" name="" scrolling="no" marginwidth="0" marginheight="0" width="300" height="250" data-is-safeframe="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="2" style="border: 0px; vertical-align: bottom;" data-load-complete="true"></iframe></div></div>
               
            </div>
            
         </aside>
      </div>
      <div class="row column">
         <hr class="dotted">
      </div>
      <footer class="row column">
         <p>Content licensed from and © 1998 - 2008 O'Reilly Media, Inc.</p>
      </footer><script type="text/javascript" src="./Adventures with OpenOffice and XML_files/782ec6c34367.js"></script>
<iframe id="google_osd_static_frame_7525246071255" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./Adventures with OpenOffice and XML_files/saved_resource.html"></iframe></body></html>